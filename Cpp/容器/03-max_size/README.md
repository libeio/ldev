
## 背景

std::deque 是标准容器中序列容器的一种，可以认为它和 std::vector/std::list 地位等同。而 std::stack, std::queue 和 std::priority_queue 都是从前面三者出发，通过定义适当界面产生的序列适配器。 

所以 std::deque 的数据结构应该是与 std::vector 和 std::list 均不同的。

std::deque 提供了序列容器通用的 push_back 操作。

std::deque 对于插入和删除是低效的，这与 std::vector 相似。但是 std::deque 可以像 std::list 一样从头部插入元素。

事实上，可以把 std::deque 理解为可以在头部操作的 std::vector。比较二者提供的函数也会发现，前者也仅比后者多了一些关于头部操作的函数。

std::deque 提供了 max_size 函数，它返回 std::deque 能够容纳的最大元素个数。

## 测试内容

std::deque 超出 max_size 后，会不会为所有元素重新分配内存。

## 测试结果

测试打印发现 max_size 是一个很大的值为 4611686018427387903 。官方说，虽然很大，但却不一定能够保证能分配这么多的空间，要看系统...

看一下每个元素所在的地址值吧...
先存储 10 个元素，打印地址值如下:
```shell
    0x1c68448 0x1c6844c 0x1c68450 0x1c68454 0x1c68458 0x1c6845c 0x1c68460 0x1c68464 0x1c68468 0x1c6846c
```
再在头部插入 5 个元素，之后打印地址值如下:
```shell
    0x1c68434 0x1c68438 0x1c6843c 0x1c68440 0x1c68444 0x1c68448 0x1c6844c 0x1c68450 0x1c68454 0x1c68458 0x1c6845c 0x1c68460 0x1c68464 0x1c68468 0x1c6846c
```
元素值为 int 类型，长度为 4 个字节，而每个地址值也是按 4 个字节的长度增加的。

猜测 std::deque 的数据结构仍然是一个数组，只不过不是从数组的第一个位置开始存储，应该是预留了一部分空间供头部插入操作。

虽然 std::deque 没有提供类似 reserve 的函数来限定容量，但想到既然是数组实现，那么 std::deque 在 size 达到一定长度之后(当前内存块不足)，应该也会为所有元素重新分配内存。