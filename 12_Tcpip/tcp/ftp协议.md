
## FPT 进程模型
- 大多数 FTP 服务器的实现允许多个客户的并发存取。
- 客户使用 TCP 连接到服务器。
- 一个主服务器进程等待连接，并为每个连接的处理建立一个从进程。
- 从进程只接受和处理来自客户的控制连接，另外还需要使用一个额外的进程和一条额外的 TCP 连接来
  处理每次数据传送操作。
- 控制连接承载的是告诉服务器将传送哪个文件的命令，而每次数据传送操作(即每个文件的传送)都需
  要分别在客户端和服务器建立一条新的 TCP 连接和一个新的进程。
- 数据传送连接和使用连接的数据传送进程可以在需要时动态创建，但控制连接在整个会话期间持续。
  一旦控制连接消失，会话也就终止了，并且两端的软件将终止所有的数据传送进程。
  
## TCP 端口号和数据连接流程
- 在客户构造一条到服务器的初始连接时，客户使用的是一个任意分配的本地协议端口号，并与一个服务
  器的一个熟知端口(21)联系。服务器使用该端口控制来自多个客户的连接。
- 客户从本地获取一个未用的端口，并通过控制连接将这个端口号发送出去，然后等待服务器构造一条到
  达指定端口的 TCP 连接。也就是说，在构造数据连接时，FTP 客户变成了服务器，而 FTP 服务器则变
  成了客户。
- FTP 服务器在构造数据连接时，使用的是为 FTP 数据传送而保留的端口(20)。
- 客户控制进程(位于服务端)获取一个任意的本地端口用于文件传送，在客户机上创建一个传送进程用于
  监听该端口，通过控制连接将端口号告知服务器，然后等待服务器建立一条到达该端口的 TCP 连接。
