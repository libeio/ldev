
### 物理层多播 - 硬件多播

硬件广播
* 在大多数据硬件技术中，计算机通过把分组发送给一个特殊的称为广播地址址的保留目的地址，来指定广播交付。
* 以太网硬件地址由 48 位比特标识符构成，每一比特均为"1"的地址表示广播地址。每台机器上的硬件都可以识别本机的硬件地址以及广播地址，对目的地址为这两者之一的传入分组都接收。
* 广播的主要缺点是对资源的消耗，除了使用网络带宽外，每个广播都会让网络上的所有计算机运用计算机资源。

硬件多播
* 与广播方式不同，多播方式允许每个系统自己选择是否参与到某个特定的多播群组中。
* 一般来说，硬件技术会保留大量的用于多播的地址，当一组机器之间要进行通信时，它们就选择一个特定的多播地址。在配置好可以识别该多播地址的网络接口硬件之后，该组中的所有机器都会收到传送给这个多播地址的任何分组的副本。
* 尽管把多播编址看成是包含了单播和广播地址的一般化形式好像会有帮助，但底层转发和交付机制会使多播效率更低。


### 链路层多播 - 以太网多播

以太网有一半的地址都是为多播而保留的。

以太网使用高八位组的低位比特来区分常规单播地址(0)和多播地址(1)。如 "01-00-00-00-00-00" 。


## 网络层多播 - IP 多播

通常所说的多播就是指这个。

在人们使用多播功能之前，一直采用广播的方式，那时广播将数据发给所有终端主机，再由这些主机 IP 之上的一层去判断是否有必要接收数据。是则接收，否则丢弃。

然而这种方式会给那些毫无关系的网络或主机带来影响，造成网络上很多不必要的流量。况且由于广播无法穿透路由，若想给其他网段发送同样的包，就不得不采取其他机制。因此，多播这种既可以穿透路由器，又可以现只给那些必要的组发送数据包的技术就应运而生了。

IP 多播特点如下:
* IP 最多可同时提供 2^28 个多播群组的地址。
* 一台主机可随时加入或退出一个 IP 多播群组，也可以同时参加任意数目的多播群组。
* 在实现方式上，如果底层网络硬件支持多播，IP 就使用硬件来发送 IP 多播。如果硬件不支持多播，IP 则使用广播或单播来交付 IP 多播。
* IP 多播群组中的成员可以连到多个物理网络上，所以需要建立在常规路由器基础上的多播路由器来转发 IP 多播。
* IP 多播使用尽最大努力交付机制，多播数据报可能丢失、延迟、重复或无序到达。因此不保证可靠传输。
* 任意主机都可以向任意一个多播群组发送数据报。

IP 层保留了 D 类地址用于多播，除了少数几个静态 IP 多播地址，其他地址均是动态临时分配的，可公开使用。具体说明如下:
* IP 地址的前 4 比特是 1110，指出这是个多播地址，其他 28 比特标识了特定的多播群组，其中不再有结构层次。
* 多播地址的范围：224.0.0.0 至 239.255.255.255 。
* 一直到 224.0.0.255 的地址都限制在单个网络上使用(禁止路由器转发发往该范围的数据报)。

多播地址语义
* IP 对待多播地址的方式与对待单播地址不同。
* 多播地址只可作为目的地址，因此多播地址从不会出现在数据报的源地址字段，也不会出现在源路由或记录路由选项中。
* 多播地址不会生成 ICMP 报文，因此发往多播地址的 ping 命令是得不到回应的。

IP 多播交付方式
* IP 多播既可用在单个网络上，也可用在互联网上。对于前者，主机只要直接把数据报放在一帧中，并使用接收方正在监听的一个硬件多播地址，就可以把它发给目的主机。对于后者，多播路由器负责在网络间转发多播数据报。
* 本地多播和非本地多播的主要区别在于多播路由器，而不是主机。

多播作用域 - 时间和空间
* IP 使用两种技术控制多播作用域的范围。
* 数据报生存时间(TTL)字段控制范围。例如，对于同一网络上的主机和路由器之间通信的控制报文，标准规定其 TTL 必须为1。
* 由一些保留的地址空间组成确定管理范围，这些地址空间仅用于某网点或某机构内部的本地群组。


### 网际组管理协议(IGMP)与多播

IGMP 在多播中的使用
* 为了参与跨越多个网络的多播，主机必须通过本地多播路由器。
* 多播路由器和实现多播的主机必须使用网际组管理协议(IGMP)来进行群组成员信息的通信。
* 虽然 IGMP 使用 IP 数据报来携带报文，但我们认为 IGMP 是 IP 协议整体的一部分，而不是一个独立的协议。

IGMP 的两个工作阶段：
* 主机新加入多播群组时，它向该群组多播地址发送一个 IGMP 报文，表明其成员关系。本地多播路由器接收报文后向互联网其他多播路由器传播这个群组成员信息，以建立必要的路由。
* 本地多播路由器周期性探询本地网络上的主机，以便确定各个群组是否仍然有成员存在。
    
IGMP 主机通过源地址过滤器来指定其是否应当容纳或排除来自某个源地址的多播通信量。即使加入了某个群组，也可以拒绝为自特定源发往这个群组的数据报。

IGMP 的实现
* 主机与多播路由器之间的所有通信都使用 IP 多播，且携带 IGMP 报文的数据报在传输过程中尽量利用硬件的多播能力。
* 多播路由器采用间隔时间探询方式请求得到关于群组的信息。
* 多个多播路由器连接到同一个网络，会选出一个路由器负责探询。
* 为避免同时响应报文，主机通过指定一个最大响应时间，在其范围内选择一个时延来发送响应报文。


### 多播路由转发与选择协议

说明
* 多播转发和常规转发不同，它更难实现。
* 在单播路由选择中，只有当拓扑结构改变或设备出故障时才会发生路由改变，而多播路由选择则不同，一个应用程序加入或退出多播群组就会造成多播路由的变化。
* 多播转发时路由器要检查的不只是目的地址，比如一台主机向处于不同网络的群组成员发送数据报。
* 多播数据报可以从非多播群组成员的主机上发起，并且可能转发经过没有任何群组成员的网络。

多播路由选择协议
* 距离向量多播路由选择协议
* 核心基干树
* 协议无关多播
* OSPF 的多播扩展

