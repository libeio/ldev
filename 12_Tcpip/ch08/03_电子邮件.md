
### 工作机制

早期的电子邮件，发送端主机与接收端主机之间会建立一个直接的 TCP 连接，再进行邮件的收发。然而，这种方法要求两端主机都必须插电，且一直处于连网的状态才行，否则可能会收不到邮件。
* 当无法与对端主机进行通信时，发送端会稍等一段时间后尝试重发。然而，如果发送端主机已经拔掉电源，那么在它再次插电之前邮件将无法发送出去。
* 如果接收端主机关闭电源或没有连接互联网，也无法接收邮件。

为此，在技术上改变了以往直接在发送端与接收端主机之间建立 TCP 连接的机制，引进了一种一直会连接电源的邮件服务器。发送和接收端通过邮件服务器进行收发邮件。接收端从邮件服务器接收邮件时使用POP3(Post Office Protocol)协议。

SMTP 是发送电子邮件的协议。它使用的是 TCP 的 25 号端口。SMTP 建立一个 TCP 连接以后，在这个连接上进行控制和应答以及数据的发送。客户端以文本的形式发出请求，服务端则返回一个 3 位数字的应答。

POP3 协议是一种用于接收电子邮件的协议。发送端的邮件根据 SMTP 协议将被转发给一直处于插电状态的 POP 服务器。客户端再根据 POP3 协议从 POP 服务器接收对方发来的邮件。在这个过程中，为了防止他人盗窃邮件内容，还需要进行用户验证。


### MIME

多用途网际邮件扩充(MIME)是为了通过电子邮件发送非 ASCII 数据而定义的。它使电子邮件的发送内容由原来的文本格式扩展为静态图像、动画、声音、程序等各种形式的多媒体数据。

MIME 基本上由首部和正文(数据)两部分组成。首部不能是空行，因为一旦出现空行，其后的部分将被视为正文(数据)。

Content-Type 定义了紧随首部信息的数据类型。MIME 标准规定 Content-Type 声明必须含有两个标识符，一个是内容类型，一个是子类型，中间用"/"分开，如: `Content-Type: image/jpeg` 。

如果 MIME 首部的 Content-Type 中指定 `Multipart/Mixed`，并以 `boundary=` 后面字符作为分隔符，那么可以将多个 MIME 消息组合成一个 MIME 消息，这就是 multipart 。

MIME 的 7 种基本内容类型

|   内容类型               | 中文    |  使用该类型要求数据是                           |
|:------------------------|:--------|:-----------------------------------------------|
|    text                 |  文本    |     文本的（例如一个文档）                     |
|    image                |  图像    |    一幅静止照片或计算机产生的图像             |
|    audio                |  音频    |    一段声音记录                               |
|    video                |  视频    |    包括运动的视频记录                         |
|    application          |  应用程序 |   程序的原始数据                               |
|    multipart            |  多部分  |   多个邮件部分，每个都有单独的内容类型和编码格式|
|    message              |  报文    |   一个完整的电子邮件报文或对一个报文的外部引用  |

Content-Type 内容代表性示例

| Content-Type      |   内容    |
|:------------------|:----------|
| text/plain        | 纯文本    |
| message/rfc822    | MIME 与正文 |
| multipart/mixed   | 多部分消息 |
| application/postscript | PostScript |
| application/octet-stream | 二进制数据 |
| image/gif         | GIF 图像 |
| image/jpeg        | JPEG 图像 |
| audi/basic        | AU 格式的音频文件 |
| video/mpeg        | MPEG 动画 |
| message/external-body | 包含外部消息 |
