
## 超文本传送协议 HTTP
- 特征
    + 应用层
    + 请求/响应
    + 无状态：服务器不保留以前的请求或会话的历史记录
    + 双向传输
    + 能力协商
    + 支持缓存
    + 支持中介
- 方法
    + GET
    + POST
    + PUT
    + DELETE
- 持久连接
    + HTTP 的第一个版本遵循与 FTP 一样的模式，即为每个数据传送使用一个新的 TCP 连接。
    + HTTP/1.1 并不是为每个传送使用一条 TCP 连接，而是采用持久连接作为默认方法。
    + 一旦客户打开了和特定服务器之间的一条 TCP 连接，客户就让连接在多个请求和响应过程中
      一直存在。当客户或服务器准备关闭连接时，则通知另一端，然后关闭该连接。
- 数据长度和程序输出
    + 为了允许 TCP 连接在多个请求和响应中持久存在，HTTP 要在每个响应前先发送长度。
    + 但当服务器使用像公共网关接口(CGI)这样的机制，以允许服务器上运行的计算机程序动态地
      创建万维网页面时，在发送数据之前把数据保存到文件中不可取。
    + 当到达的请求对应的是 CGI 生成的页面时，服务器运行相应的 CGI 程序，将程序的输出作为
      响应返回给客户。
    + 动态万维网页面的生成使创建的信息具有时效性，这意味着服务器不能提前知道准确的数据大小。
    + 为了提供动态的万维网页面，HTTP 标准指明，如果服务器预先不知道数据项的长度，那么服务
      器可以通知浏览器，它将在传送项目之后关闭连接。
- 长度编码和首部
    + HTTP 借用了电子邮件的基本格式，使用 2822 格式和 MIME 扩充。
    + 每个 HTTP 传送都包含一个首部、一个空行和要发送的数据项。首部中的每一行都包含一个关键
      字、一个冒号和信息。
    + 常见首部
      ```shell
        首部              含义
        Content-Length      数据项的大小，以八位组表示
        Content-Type        数据项的类型
        Content-Encoding    数据项使用的编码方式
        Content-Language    数据项使用的语言
      ```
    + 如果服务器不知道数据项的长度，那么服务器会在发送完数据项后关闭连接。在关闭之前，服务
      器会通知浏览器，希望关闭连接。为此服务器在数据项之前包含了一个 Connection:close 首部，
      以代替 Content-Length 首部。
- 协商
    + 除了使用首部交换元信息之外，HTTP 还使用首部来允许客户和服务器协商能力。
    + 可协商的一组能力包括有关连接(如访问是否是经过授权)、表示法(如是否接受 jpeg 格式的图形
      或使用哪种类型的压缩格式)、内容(如文本文件是否必须是英文)以及控制(如页面保持有效的时
      间长度)等各个方面的特征。
    + 协商类型：服务器驱动和代理驱动(浏览器驱动)。
        + 服务器驱动: 从浏览器发出请求开始，在指明所要求数据项的 URL 的同时，请求也会指明首
          选列表。服务器从可用表示法中选出符合浏览器首选要求的一项。如果有多项符合条件，则服
          务器进行"最佳猜测"。
        + 代理驱动: 首先浏览器向服务器发送请求，询问可用内容，服务器返回可能的内容列表。浏览
          器从中选择一个，发送第二个请求，以获得该数据项。虽然进行了两次交互，但浏览器得到了
          对选项的完全控制权。
    + 浏览器使用 HTTP Accept 首部指明哪种媒体或表示法是可接受的，在首部中列出了格式的名称以
      及分配给每个名称的首选值。
      ```shell
        Accept: text/html, text/plain; q = 0.5, text/x-dvi; q = 0.8
      ```
        + 它指明浏览器希望接受 text/html 媒体类型，但如果该类型不存在，则浏览器将接受
          text/x-dvi, 并且如果 text/x-dvi 也不存在，则接受 text/plain。
        + Accept 信息项通过逗号(,)分隔可选项，q 值可看作是接受该媒体类型的意愿值，不存在 q=1 
          的值，q=0 表示不接受该类型。
        + 有多种 Accept 首部，分别对应于前面描述的 Content 首部。
          ```shell
            + Accept-Encoding:
            + Accept-CharSet:
            + Accept-Language:
          ```
          它们分别用于指定编码、字符集和浏览器希望接受的语言。
    + HTTP 使用类似于 MIME 的首部运载元信息。浏览器和服务器都要发送首部，以允许它们对希望得到的
      文档的表示法和使用的编码进行协商。
- 条件请求
    + 当浏览器发送请求时，它包括的首部可以限制在何种条件下才应该响应请求。如果不符合指定的条件，
      则服务器不返回请求的数据项。
    + 例如：浏览器的 GET 请求可以包括首部：
      ```shell
        If-Modified-Since : Fri,01 Apr 2005 05:00:01 GMT
      ```
      如果数据项比2005年1月1日还要早，则会避免传送。
- 代理服务器
    + 代理形式：非透明和透明。
    + 非透明代理：对用户而言可见，用户必须配置浏览器来联络一个代理，而不是与原始资源所在的服务
      器联络。
    + 透明代理：不需要对浏览器配置作任何改动。
    + HTTP 包括对代理服务器的显式支持。
    + 例如：
      ```shell
        Max-Forwards : 1
      ```
      表示从服务器到浏览器沿途中，最多只有一个代理可以处理数据项。数字为0时禁止任何代理处理数
      据项。
- 缓存
    + 在第一次访问一个万维网页面时，由浏览器或中介代理，或者由这两者将该万维网页面的副本存储在磁
      盘上。当以后请求同一页面时，可以简化查找过程，从缓存而不是从服务器上得到万维网页面的副本。
    + 所有缓存方案的中心问题都和时限有关。
    + HTTP 允许服务器控制能否缓存页面、如何缓存页面以及页面的生存时间。浏览器可以绕过缓存，强制
      请求页面从拥有该页面的服务器上得到新的副本。
- 其他 HTTP 功能
    + HTTP 还提供了 PUT 和 POST 方法，以允许客户向服务器发送数据，这样才可能创建一段脚本，提示用
      户输入ID和口令，然后把结果传送到服务器。
    + 底层的 HTTP 协议仍然是无状态的(即在交互期间不要求保持一条持久的运输层连接)，为此通常需要用
      额外的信息来协调一系列的传送过程。例如，服务器在响应一个ID和口令时，它可能会发送一个称为 
      cookie 的用于识别的整数，并在客户的后续传送中返回。
