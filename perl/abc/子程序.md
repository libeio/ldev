
#### 什么是子程序

perl 的子程序也就是用户定义的函数。其语法格式如下:
```pl
    sub subroutine
    {
        statements;
    }
```
其调用格式如下:
```pl
    subroutine(参数列表);
```

示例:
```pl
    sub Helo
    {
        print "Hello World\n"
    }
    
    Hello();
```


#### 向子程序中传递参数

子程序参数使用特殊数组 `@_` 存储，第一个参数为 `$_[0]`, 第二个参数为 `$_[1]`, 以此类推。

不论参数是标量还是数组，用户把参数传给子程序时，perl 默认按引用方式调用它们。所以用户可以通过改变 `@_` 数组中的值来改变相应实际参数的值。
```pl
    sub Average
    {
        $n = scalar(@_);
        $sum = 0;
        
        foreach $item (@_) {
            $sum += $item;
        }
        
        return $sum / $n;
    }
```


由于 `@_` 变量是一个数组，所以 perl 允许向子程序中传递列表。
```pl
    sub PrintList
    {
        my @list = @_;
        print "@list\n";
    }
    
    $a = 10;
    @b = (1, 2, 3, 4);
    
    PrintList($a, @b);
```
需要注意的是，如果需要传入标量和数组参数时，需要把列表放在最后一个参数上。

当向子程序传递哈希表时，它将复制到 `@_` 中，哈希表将被展开为键/值组合的列表。
```pl
    sub PrintHash
    {
        my (%hash) = @_;
        
        foreach my $key (keys %hash) {
            my $value = $hash{$key};
            print "$key : $value\n";
        }
    }
    
    %hash = ('name' => "runoob", 'age' => 3);
    
    PrintHash(%hash);
```


#### 子程序的返回值

子程序可以向其他编程语言一样使用 return 语句来返回函数值。

如果没有使用 return 语句，则子程序的最后一行语句将作为返回值。


#### 子程序的私有变量

默认情况下，perl 中所有的变量都是全局变量。

可以使用 `my` 操作符设置私有变量。通过 `my` 创建的变量，存活于声明开始的地方，直到闭合作用域的结尾。

闭合作用域可以是一对花括号中的区域，可以是一个文件，也可以是一个 if, while, for, foreach, eval 字符串。


#### 静态变量

state 操作符功能类似于 C 里面的 static 修饰符， state 关键字将局部变量变得持久。

state 定义的变量只在限定作用域内有效。

state 仅能创建闭合作用域为子程序内部的变量。

state 可以声明标量、数组、哈希。但在声明数组和哈希时，不能对其初始化。

```pl
    use feature 'state';
    
    sub PrintCount
    {
        state $count = 0;   # 初始化变量
        
        $count++;
    }
    
    for (1..5) {
        PrintCount();       # 0 1 2 3 4
    }
```

#### 子程序调用上下文

即 C 语言中的函数内调用函数，或者函数以参数形式调用函数。

子程序调用过程中，会根据(变量类型，如标量或列表等)上下文来返回不同类型的值。
