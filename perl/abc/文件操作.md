
#### 说明

perl 使用一种叫做文件句柄类型(file handle)的变量来操作文件。

文件句柄是一个 I/O 连接的名称，从文件读取或者写入数据都需要使用文件句柄。

perl 提供了三种文件句柄: STDIN, STDOUT, STDERR 。分别代表标准输入，标准输出和标准错误输出。


#### open 函数

语法格式:
```pl
    open(HANDLE, mode and filename);
```

HANDLE 为文件句柄，用于操作文件。

mode 代表所选择的访问模式，如下:

| 模式 | 描述 |
|:-----|:-----|
| < 或 r    | 只读方式打开，将文件指针指向文件头 |
| > 或 w    | 写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之 |
| >> 或 a   | 写入方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之 |
| +< 或 r+  | 读写方式打开，将文件指针指向文件头 |
| +> 或 w+  | 读写方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之 |
| +>> 或 a+ | 读写方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之 |

示例:
```pl
    open(DATA, "<file.txt") or die "file.txt" 文件无法打开， $!;
    
    while (<DATA>) {
        print "$_";
    }
```


#### sysopen 函数

sysopen 函数更类似于 C 语言中的 open 函数。其语法格式如下:
```pl
    sysopen(HANDLE, filename, MODE);
```

MODE 可选项如下:

| 模式 | 描述 |
|:-----|:-----|
| O_RDWR      | 读写方式打开，将文件指针指向文件头 |
| O_RDONLY    | 只读方式打开，将文件指针指向文件头 |
| O_WRONLY    | 写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之 |
| O_CREAT     | 创建文件 |
| O_APPEND    | 追加文件 |
| O_TRUNC     | 将文件大小截为零 |
| O_EXCL      | 如果使用O_CREAT时文件存在,就返回错误信息,它可以测试文件是否存在 |
| O_NONBLOCK  | 非阻塞I/O使我们的操作要么成功，要么立即返回错误，不被阻塞 |

示例:
```pl
    sysopen(DATA, "file.txt", O_RDWR);
    sysopen(DATA, "file.txt", O_RDWR|O_TRUNC );
```


#### close 函数

在文件使用完后，要关闭文件，以刷新与文件句柄相关联的输入输出缓冲区，关闭文件的语法如下:
```pl
    close(HANDLE);
```
HANDLE 为指定的文件句柄，如果成功关闭则返回 true。


#### 读文件

> 通过文件句柄读取

```pl
    open(DATA, "<import.txt") or die "无法打开文件";
    @lines = <DATA>;
    print @lines;
    close(DATA);
```

> 通过 read 函数读取

函数形式如下:
```pl
    read HANDLE, SCALAR, LENGTH, OFFSET
    read HANDLE, SCALAR, LENGTH
```
参数说明:
```pl
    HANDLE: 文件句柄
    SCALAR：存贮结果，如果没有指定OFFSET，数据将放在SCALAR的开头。否则数据放在SCALAR中的OFFSET字节之后
    LENGTH：读取的内容长度
    OFFSET：偏移量
```
如果读取成功返回读取的字节数，如果在文件结尾返回 0，如果发生错误返回 undef。


#### 写文件

perl 没有 write 函数，但可以通过 print 函数写入。此时写入格式如下:
```pl
    print HANDLE LIST
```

利用 print 实现文件的拷贝:
```pl
    open(IN, "<infile.txt");
    open(OUT, ">outfile.txt");
    
    while (<IN>) {
        print OUT $_;
    }
    
    close(IN);
    close(OUT);
```

#### 指定文件位置

使用 tell 函数来获取文件的位置，并通过使用 seek 函数来指定文件内的的位置。

tell 函数用于获取文件位置:
```pl
    tell HANDLE
    tell
```
如果指定 HANDLE 该函数返回文件指针的位置，以字节计。如果没有指定则返回默认选取的文件句柄。

seek 函数通过文件句柄来移动文件读写指针的方式来读取或写入文件的，以字节为单位进行读取和写入:
```pl
    seek HANDLE, POSITION, WHENCE
```
参数说明:
```pl
    POSITION: 表示文件句柄相对 WHENCE 要移动的字节数
    WHENCE:   表示文件句柄开始移动时的起始位置，可取值 0,1,2, 分别表示文件开头、当前位置和文件尾
```

从文件开头读取 256 个字节:
```pl
    seek HANDLE, 256, 0;
```


#### 重命名文件

通过 rename 来实现对文件的重命名:
```pl
    rename("old.txt", "new.txt");
```


#### 删除文件

使用 unlink 函数来删除文件：

```pl
    unlink("unuse.txt");
```



