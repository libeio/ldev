
函数一般用来实现数据处理过程中的特定运算与操作，分为内部函数和用户自定义函数两类。

用户自定义函数是用户根据自己需要定义的函数；内部函数也称为标准函数或库函数。

常用的内部函数可分为数学函数、转换函数、字符串函数、日期时间函数等。

函数的使用方法如下:
```
    函数名 [<参数列表>]
```
其中，函数的参数可以是常量 、变量或表达式。如果有多个参数，参数之间以逗号隔开。


### 数学函数

|  函数名  |   含义   | 实例 | 结果 |
|:---------|:---------|:-----|:-----|
| Abs(N)   | 取绝对值 | Abs(-4) | 4 |
| Sin(N)   | 正弦函数 | Sin(0)  | 0 |
| Cos(N)   | 余弦函数 | Cos(0)  | 1 |
| Tan(N)   | 正切函数 | Tan(0)  | 0 |
| Exp(N)   | 以 e 为底的指数函数 | Exp(3) | 20.086 |
| Log(N)   | 以 e 为底的自然对数 | Log(8) | 2.079  |
| Rnd(N)   | 产生随机数 | Rnd | \[0,1)之间的随机数  |
| Sgn(N)   | 取正负号函数 | Sgn(5) | 1 |
| Round(N) | 四舍五入取整 | Round(3.6) | 4 |
| Sqr(N)   | 求平方根 | Sqr(9) | 3 |

在三角函数中，N 是一个数值表达式，必须以弧度表示。


### 转换函数

|  函数名  |   含义   | 实例 | 结果 |
|:---------|:---------|:-----|:-----|
| Fix(N)   | 取整     | Fix(3.6) | 3 |
| Int(N)   | 取小于等于N的最大整数 | Int(3.6) | 3 |
| Asc(N)   | 将字符串转换为 ASCII 码值 | Asc("A") | 65 |
| Chr(N)   | 将 ASCII 码值转换为字符 | Chr(65) | "A" |
| Val(N)   | 将数字字符串转换为数值 | Val("345AB") | 345 |
| Str(N)   | 将数值转换为字符串 | Str(345) | "345" |


### 字符串函数

|   函数名   |   含义   | 实例 | 结果 |
|:-----------|:---------|:-----|:-----|
| Ltrim(S)   | 删除字符串 S 左边的空格 | Ltrim("  Sub") | "Sub" |
| Rtrim(S)   | 删除字符串 S 右边的空格 | Rtrim("Sub  ") | "Sub" |
| Trim(S)    | 删除字符串 S 两边的空格 | Trim(" Sub  ") | "Sub" |
| Left(S, N) | 取字符串 S 左边的 N 个字符 | Left("Subject", 3) | "Sub" |
| Right(S, N)| 取字符串 S 右边的 N 个字符 | Right("Subject", 4) | "ject" |
| Mid(S, N1, N2) | 取字符串 S 中从 N1 位置起的 N2 个字符 | Mid("Subject", 4, 4) | "ject" |
| Len(S)     | 返回字符串 S 的长度 | Len("Subject") | 7 |
| Space(N)   | 返回 N 个空格 | Space(3) | "   " |
|InStr(S1, S2) | 返回字符串 S2 在 S1 中首次出现的位置 | InStr("Subject", "ject") | 4 |

就函数返回值的类型来说，除了 InStr 和 Len 函数返回整型值外，其余都返回字符串。


### 日期时间函数

|   函数名   |   含义   | 实例 | 结果 |
|:-----------|:---------|:-----|:-----|
| Now        | 返回系统的日期和时间 | Now | 2021-01-30 19:34:56 |
| Date       | 返回系统当前日期 | Date() | 2021-01-30 |
| Time       | 返回系统当前时间 | Time | 19:34:56 |
| Minute     | 返回分(0~59)     | Minute(Now) | 34 |
| Second     | 返回秒(0~59)     | Second(Now) | 56 |
| DateSerial | 返回一个日期形式 | DateSerial(21, 1, 30) | 2021-1-30 |


日期函数中的参数 N 可以是字符串表达式，也可以是数值表达式。

除了上述日期函数外，还有两个有用的日期函数 DateAdd 和 DateDiff 。

> DateAdd

对要增减的日期变量按规定的日期形式做增减。

格式如下:
```vb
    DateAdd(要增减的日期形式, 增减量, 要增减的日期变量)
```

要增减的日期形式取值如下:

|  日期形式  | yyyy |     y      |  q   |  m  |  d  |  ww  |      w     |  h   | n  | s  |
|:----------:|:----:|:----------:|:----:|:---:|:---:|:----:|:----------:|:----:|:--:|:--:|
| 含义       | 年   | 一年的天数 |  季  | 月  |  日 | 星期 | 一周的天数 | 小时 | 分 | 秒 |

示例:
```vb
    DateAdd("d", 15, #9/10/2021#)
```

> DateDiff

对两个指定的日期按日期形式求相差的日期。

格式如下:
```vb
    DateDiff(要间隔的日期形式, 日期1, 日期2)
```

示例:
```vb
    DateDiff("d" #9/10/2015#, #12/31/2021#)
```


### 随机函数和 Randomize 语句

Rnd[(x)] 返回一个 `[0,1)` 的单精度随机值。

Rnd 函数通常与 Int 函数配合使用，产生 `[a,b]` 区间的随机整数，其使用方法通常如下:
```vb
    Int((b - a + 1) * Rnd) + a
```

设置随机数种子的函数:
```vb
    Randomize [seed]
```

